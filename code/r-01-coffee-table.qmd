---
output: html
html-table-processing: none
---

# Code Along in R: Coffee Table

Setting up.

```{r}
library(gt)
library(tidyverse)
```

Importing the data.

```{r}
coffee_sales <- readr::read_csv("data/coffee-sales.csv")

coffee_sales
```

`gt()`

```{r}
gt_tbl <- gt(______) # <- what do we introduce to gt()?

gt_tbl
```

## Adding Structure to the Table

`tab_header()`

```{r}
gt_tbl <- gt_tbl |> tab_header(title = "Sales of Coffee Equipment")

gt_tbl
```

`tab_spanner()`

```{r}
gt_tbl <-
    gt_tbl |>
    tab_spanner(label = "Revenue", columns = starts_with("revenue")) |>
    tab_spanner(label = "Profit", columns = starts_with("______")) # <- ?

gt_tbl
```

`cols_label()`

```{r}
gt_tbl <-
    gt_tbl |>
    cols_label(
        icon = "______", # <- We want no label above the icon
        product = "Product",
        revenue_dollars = "Amount",
        profit_dollars = "Amount",
        revenue_pct = "Percent",
        profit_pct = "Percent"
    )

gt_tbl
```

## Formatting Values Within the Table Body

`fmt_currency()`

```{r}
gt_tbl <- 
    gt_tbl |>
    fmt_currency(
        columns = ______("______"), # <- Need to select columns here
        use_subunits = FALSE
    )

gt_tbl
```

`fmt_percent()`

```{r}
gt_tbl <-
    gt_tbl |>
    fmt_percent(
        columns = ends_with("______"), # <- What string do we use?
        decimals = 0
    )

gt_tbl
```

## Styling the Table

`.tab_style()` - 1

```{r}
gt_tbl <-
    gt_tbl |>
    tab_style(
        style = cell_fill(color = "aliceblue"),
        locations = cells_body(columns = ______("revenue")) # <- ?
    )

gt_tbl
```

`.tab_style()` - 2

```{r}
gt_tbl <-
    gt_tbl |>
    tab_style(
        style = ______(color = "papayawhip"), # <- fn for specifying a fill?
        locations = cells_body(columns = ______("profit"))  # <- ?
    )

gt_tbl
```

`.tab_style()` - 3

```{r}
gt_tbl <-
    gt_tbl |>
    tab_style(
        style = cell_text(weight = "bold"),
        locations = cells_body(rows = product == "______") # <- What str?
    )
```

## Adding a Column of Nanoplots

`cols_nanoplot()`

```{r}
gt_tbl <-
    gt_tbl |>
    cols_nanoplot(
        columns = monthly_sales, 
        plot_type = "bar",
        new_col_name = "nanoplots",
        new_col_label = "Monthly Revenue" 
    )

gt_tbl
```

## Adding Images to the Table

`fmt_image()`

```{r}
gt_tbl <-
    gt_tbl |>
    fmt_image(
        columns = icon,
        path = "img/"
    )

gt_tbl
```

## Making Some Final Tweaks

`sub_missing()`

```{r}
gt_tbl <- gt_tbl |> sub_missing(missing_text = "")

gt_tbl
```
